<div class="container">

  <h1 class="mt-3 mb-3"><%= I18n.t 'events.my_events' %></h1>

  <% if @events.empty? %>
    <p><%= I18n.t 'events.no_events' %></p>
  <% else %>
    <% @events.each do |event| %>
      <div class="card p-3 border-0 mb-3">
        <div class="d-flex justify-content-between align-items-baseline">
          <h2 class="mb-3"><%= I18n.with_locale(current_user.locale) { I18n.l(event.start_time, format: "%d %B") } %></h2>
          <h3 class="mb-3"><%= "#{event.start_time.strftime('%Hh%M')} - #{event.end_time.strftime('%Hh%M')}" %></h3>

          <h1 data-notifications-subscription-target="eventPill"
              data-event-index="<%= event.id %>"
          >


        </div>
        <div class="d-flex justify-content-between align-items-end">
          <% participants = event.bookings.select(&:accepted).map(&:user) %>
          <% free_slots = event.slots - participants.size %>

          <div class="d-flex align-items-center">
            <%= image_tag event.gym.logo, alt: "logo", width: 30, height: 30, class: "rounded-circle me-2" %>
            <p class="mb-0"><%= event.gym.name %></p>
          </div>

          <div class="d-flex align-items-baseline">
              <%= cl_image_tag event.owner.avatar.key, height: 40, width: 40, class: "rounded-circle me-1" %>
              <% participants.each do |participant| %>
                <%= cl_image_tag participant.avatar.key, height: 30, width: 30, class: "rounded-circle me-1" %>
              <% end %>
              <% free_slots.times do %>
                <%= image_tag 'Blank-Avatar.png', alt: "blank avatar", width: 30, height: 30, class: "rounded-circle me-1" %>
              <% end %>
          </div>

        </div>
        <%= link_to (I18n.t 'events.see_event'), event_path(event), class: "btn btn-full w-100 mt-3" %>
      </div>
    <% end %>
  <% end %>
  <div class="mb-custom">
</div>
